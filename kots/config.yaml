apiVersion: kots.io/v1beta1
kind: Config
metadata:
  name: kots-validation
spec:
  groups:
    - name: database
      title: Database
      description: Database Options
      items:
        - name: postgres_type
          type: select_one
          title: Postgres
          default: embedded_postgres
          items:
            - name: embedded_postgres
              title: Embedded Postgres
            - name: external_postgres
              title: External Postgres
        - name: embedded_postgres_password
          hidden: true
          type: password
          value: "{{repl RandomString 32}}"
        - name: external_postgres_uri
          title: Postgres URI
          when: '{{repl ConfigOptionEquals "postgres_type" "external_postgres"}}'
          type: password
          default: db.mycompany.internal
    - name: company
      title: Company Information
      description: Basic branding for the org
      items:
        - name: company_name
          title: Company Name
          type: text
          default: my company name
    - name: api
      title: API settings
      description: How the API is exposed
      items:
        - name: service_type
          type: select_one
          title: Service Type
          default: node_port
          items:
            - name: node_port
              title: Node Port (exposed externally)
            - name: clusterip
              title: ClusterIP (not exposed externally)
        - name: node_port_port
          type: text
          value: "8801"
          when: '{{repl ConfigOptionEquals "service_type" "node_port"}}'
